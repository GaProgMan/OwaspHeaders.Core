# Changelog

This changelog represents all of the major (i.e. breaking) changes made to the OwaspHeaders.Core project since it's inception. Early in the repo's development, GitHub's "releases" where used to release builds of the code repo. However shortly after it's inception, builds and releases where moved to [AppVeyor](https://ci.appveyor.com/project/GaProgMan/owaspheaders-core). Because of this, the releases on the GitHub repo became stale.

### Version 4

This version of the repo removed the XSS Protection Header from the list of default headers in the `BuildDefaultConfiguration()` extension method. This is related to [issue #44](https://github.com/GaProgMan/OwaspHeaders.Core/issues/44).

### Version 3

This version of the repo removed the dependency on .NET Core 2.0, and replaced it with a dependency on .NET Standard 2.0 (via the `netstandard2.0` Target Framework Moniker), and the version of the [Microsoft.AspNetCore.Http.Abstractions](https://www.nuget.org/packages/Microsoft.AspNetCore.Http.Abstractions/) was upped to version 2.1.1

This version of the repo was also changed to use the [Builder Pattern](https://en.wikipedia.org/wiki/Builder_pattern) for creating an instance of the `SecureHeadersMiddlewareConfiguration` class. This decision was taken because the configuration should be a build-time decision, rather than a runtime one. As such, a default builder was created for the `SecureHeadersMiddlewareConfiguration` class, which could be generated by calling the following:

``` csharp
app.UseSecureHeadersMiddleware(SecureHeadersMiddlewareExtensions.BuildDefaultConfiguration());
```

within the Startup class. This would call the following method:

``` csharp
public static SecureHeadersMiddlewareConfiguration BuildDefaultConfiguration()
{
    return SecureHeadersMiddlewareBuilder
        .CreateBuilder()
        .UseHsts()
        .UseXFrameOptions()
        .UseXSSProtection()
        .UseContentTypeOptions()
        .UseContentDefaultSecurityPolicy()
        .UsePermittedCrossDomainPolicies()
        .UseReferrerPolicy()
        .Build();
}
```

#### TODO

Add a description of the changes for the following commits:

- [#64755e2ee737ebcc78f5c29ae46b415b19aff73e](https://github.com/GaProgMan/OwaspHeaders.Core/commit/64755e2ee737ebcc78f5c29ae46b415b19aff73e#diff-f27c7085d1d957d0187b20ee09fe6eea) 3.0.0.0
- [#e798771be5df9cda3a0caed47fafa4100b75bc5c](https://github.com/GaProgMan/OwaspHeaders.Core/commit/e798771be5df9cda3a0caed47fafa4100b75bc5c#diff-f27c7085d1d957d0187b20ee09fe6eea) 3.0.0.2
- [#1d67636e5cba8bde9cc8db2a532bd222ae0bbd4d](https://github.com/GaProgMan/OwaspHeaders.Core/commit/1d67636e5cba8bde9cc8db2a532bd222ae0bbd4d#diff-f27c7085d1d957d0187b20ee09fe6eea) 3.0.0.3
- [#267dd95d8a19d71357c39f94368e2e93ff11be3c](https://github.com/GaProgMan/OwaspHeaders.Core/commit/267dd95d8a19d71357c39f94368e2e93ff11be3c#diff-f27c7085d1d957d0187b20ee09fe6eea) 3.1.0.0
- [#8ed2f38f638baf72875188a8eaf8857d4721ffe8](https://github.com/GaProgMan/OwaspHeaders.Core/commit/8ed2f38f638baf72875188a8eaf8857d4721ffe8#diff-f27c7085d1d957d0187b20ee09fe6eea) 3.1.1.0
- [#c991bede1a7ee1946d5850bc292044b70617e6e4](https://github.com/GaProgMan/OwaspHeaders.Core/commit/c991bede1a7ee1946d5850bc292044b70617e6e4#diff-f27c7085d1d957d0187b20ee09fe6eea) 3.1.1
  - Added SVG logo
- [#e64a5a3355e45456982ef5d080d1b747865b6c4b](https://github.com/GaProgMan/OwaspHeaders.Core/commit/e64a5a3355e45456982ef5d080d1b747865b6c4b#diff-f27c7085d1d957d0187b20ee09fe6eea) 3.2.0
- [#ce2bb6683e1349da0a54c6498e4c1d866f9dd5aa](https://github.com/GaProgMan/OwaspHeaders.Core/commit/ce2bb6683e1349da0a54c6498e4c1d866f9dd5aa#diff-f27c7085d1d957d0187b20ee09fe6eea) 3.3.2
- [#7fa1b4c62cf5cf4f0304bc01549ce52d5886fc02](https://github.com/GaProgMan/OwaspHeaders.Core/commit/7fa1b4c62cf5cf4f0304bc01549ce52d5886fc02#diff-f27c7085d1d957d0187b20ee09fe6eea) 3.5.2


---

### Version 2

This version of the repo continued to use the `secureHeaderSettings.json`, which was consumed in the Startup class. However, this version of the repo has an explicit dependency on .NET Core 2.0 (it uses the `netcoreapp2.0` Target Framework Moniker), and [Microsoft.AspNetCore.Http.Abstractions version 2.0.0](https://www.nuget.org/packages/Microsoft.AspNetCore.Http.Abstractions/2.0.0).

### Version 1

The initial version of the repo relied on the presence of .NET Standard 1.0 and [Microsoft.AspNetCore.Http.Abstractions version 1.1.1](https://www.nuget.org/packages/Microsoft.AspNetCore.Http.Abstractions/1.1.1).

The initial version of the repo used a file called `secureHeaderSettings.json` which took the following format:

``` json
{
    "SecureHeadersMiddlewareConfiguration": {
        "UseHsts": "true",
        "HstsConfiguration": {
            "MaxAge": 42,
            "IncludeSubDomains": "true"
        },
        "UseHpkp": "true",
        "HPKPConfiguration" :{
            "PinSha256" : [
                "e927fad33f9eb96126896413502a1034be0ca379dec377fb891feb9ebc720e47"
                ],
            "MaxAge": 3,
            "IncludeSubDomains": "true",
            "ReportUri": "https://github.com/GaProgMan/OwaspHeaders.Core"
        },
        "UseXFrameOptions": "true",
        "XFrameOptionsConfiguration": {
            "OptionValue": "allowfrom",
            "AllowFromDomain": "com.gaprogman.dotnetcore"
        },
        "UseXssProtection": "true",
        "XssConfiguration": {
            "XssSetting": "oneReport",
            "ReportUri": "https://github.com/GaProgMan/OwaspHeaders.Core"
        },
        "UseXContentTypeOptions": "true",
        "UseContentSecurityPolicy": "true",
        "ContentSecurityPolicyConfiguration": {
            "BlockAllMixedContent": "true",
            "UpgradeInsecureRequests": "true"
        }
    }
}
```

This was read and used to construct an instance of the `SecureHeadersMiddlewareConfiguration` class (which represented the values used to render the secure headers) at runtime.

The json file containing the configuration was loaded in the Startup class in the following manner:

``` csharp
public Startup(IHostingEnvironment env)
{
    var builder = new ConfigurationBuilder()
    .SetBasePath(env.ContentRootPath)
    .AddJsonFile("appsettings.json", optional: true, reloadOnChange: true)
    .AddJsonFile($"appsettings.{env.EnvironmentName}.json", optional: true)
    .AddJsonFile("secureHeaderSettings.json", optional:true, reloadOnChange: true)
    .AddEnvironmentVariables();
    Configuration = builder.Build();
}
```

As the code used the default configuration builder, changing the contents of the `secureHeaderSettings.json` would force the consuming application to reboot. This would mean that requests which were being dealt with _could_ be destroyed, and responses never generated for them.